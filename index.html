<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Følgeseddel - Felson Watersafe ApS</title>

  <!-- Seguridad básica (CSP) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    :root{
      --primary:#00B0F0;   /* azul agua corporativo */
      --secondary:#8B5CF6; /* mantenemos por si quieres el degradado */
      --success:#10B981;
      --danger:#EF4444;
      --bg-light:#F9FAFB;
      --text:#111827;
      --text-gray:#6B7280;
      --border:#E5E7EB;
    }

    body{
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f1f5f9;
      min-height:100vh; padding:24px;
    }

    .container{max-width:900px; margin:0 auto;}
    .document{
      background:#fff; border-radius:16px; overflow:hidden; position:relative;
      box-shadow:0 20px 40px rgba(0,0,0,.12);
      display:flex; flex-direction:column;
      min-height:calc(100vh - 48px);
    }

    /* Faja superior muy sutil */
    .document::before{
      content:''; position:absolute; top:0; left:0; right:0; height:4px;
      background: linear-gradient(90deg, var(--primary), #5B21B6, #A78BFA);
    }

    /* HEADER: ambos textos a la derecha, uno bajo el otro */
    .header{
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      padding: 16px 24px 12px;
      display:flex; justify-content:flex-end; align-items:flex-start;
    }
    .header-right{ text-align:right; }
    .company-name{
      color:#fff; font-size:1.45rem; font-weight:800; letter-spacing:-.2px; margin:0;
    }
    .document-title{
      color:rgba(255,255,255,.95); margin:4px 0 0 0;
      font-size:1.05rem; letter-spacing:2px; text-transform:uppercase; font-weight:600;
    }

    .content{ padding: 16px 24px 20px; flex:1; }

    /* Menos espacio entre Dato / Ordre / Levering */
    .info-grid{
      display:grid; grid-template-columns:1fr 1fr; gap:10px 14px; margin-bottom:14px;
    }
    .field-group{}
    .field-label{ font-size:.84rem; font-weight:600; color:var(--text-gray); margin-bottom:4px; text-transform:uppercase; letter-spacing:.3px; }
    .field-input{
      width:100%; padding:.6rem .75rem; border:2px solid var(--border); border-radius:10px;
      background:var(--bg-light); font-size:1rem;
    }
    .field-input:focus{ outline:none; border-color:var(--primary); background:#fff; box-shadow:0 0 0 3px rgba(0,176,240,.15); }

    .field-textarea{ resize:vertical; min-height:88px; font-family:inherit; }

    .table-container{ background:var(--bg-light); border-radius:12px; padding:12px; margin-bottom:12px; }
    table.table{ width:100%; border-collapse:separate; border-spacing:0 .5rem; }
    .table thead th{
      text-align:left; padding:.7rem 1rem; color:var(--text-gray); font-weight:700; font-size:.84rem; text-transform:uppercase;
    }
    .table tbody tr{ background:#fff; box-shadow:0 1px 3px rgba(0,0,0,.06); }
    .table td{ padding:.75rem 1rem; vertical-align:top; }
    .table td:first-child{ width:120px; border-right:1px solid #d9dee6; } /* separador vertical ANTAL|BESKRIVELSE */

    .table-input{ width:100%; padding:.58rem .7rem; border:1px solid transparent; background:var(--bg-light); border-radius:8px; font:inherit; }
    .table-input:focus{ outline:none; border-color:var(--primary); background:#fff; box-shadow:0 0 0 3px rgba(0,176,240,.12); }
    .table-number{ text-align:center; }

    .btn-delete{
      background:#fff; border:2px solid var(--danger); color:var(--danger);
      width:36px; height:36px; border-radius:10px; cursor:pointer;
    }
    .btn-delete:hover{ background:var(--danger); color:#fff; }

    .btn-add{
      background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      color:#fff; border:none; padding:.8rem 1.2rem; border-radius:10px; font-weight:700; margin-top:.6rem; cursor:pointer;
    }

    .actions{ display:flex; gap:.75rem; justify-content:center; margin-top:12px; }
    .btn-action{ padding:.9rem 1.6rem; border-radius:10px; font-weight:700; cursor:pointer; border:2px solid var(--primary); }
    .btn.primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
    .btn.secondary{ background:#fff; color:var(--primary); }

    /* Footer fijo al fondo en pantalla (flex empuja) */
    .footer{
      margin-top:auto; padding:14px 16px; text-align:center; color:var(--text-gray);
      font-size:.82rem; line-height:1.5; border-top:2px solid var(--primary); /* línea separadora azul agua */
      background:#fff;
    }

    /* Responsivo ligero */
    @media (max-width: 768px){
      .info-grid{ grid-template-columns:1fr; }
      .company-name{ font-size:1.25rem; }
      .document-title{ font-size:.95rem; }
    }

    /* ===== PRINT: header & footer fijos en cada página, placeholders visibles, tabla correcta ===== */
    @page { size: A4; margin: 2.5cm 2cm 2.2cm; }

    @media print{
      body{ background:#fff !important; padding:0 !important; }
      .document{ box-shadow:none; border-radius:0; }

      /* Header fijo en todas las páginas */
      .header{
        position:fixed; top:0; left:0; right:0;
        background:#fff !important; border-bottom:1px solid #000 !important;
        padding:12px 24px !important; z-index:9999;
        display:flex; justify-content:flex-end; align-items:flex-start;
      }
      .company-name, .document-title{ color:#000 !important; }
      /* Reserva espacio bajo header fijo */
      .content{ margin-top: 95px !important; }

      /* Footer fijo en todas las páginas */
      .footer{
        position:fixed; bottom:0; left:0; right:0; z-index:9999;
        background:#fff !important; border-top:2px solid #000 !important; /* en BN al imprimir */
        font-size:.8rem !important; padding:10px 16px !important; color:#000 !important;
      }
      /* Reserva espacio antes del pie */
      .table-container{ margin-bottom: 85px !important; }

      /* Repetir cabecera de tabla y evitar cortes feos */
      .table thead{ display:table-header-group; }
      .table tfoot{ display:table-footer-group; }
      .table{ page-break-inside:auto; }
      .table tr{ page-break-inside:avoid; }

      /* UI fuera del papel */
      .btn-add, .btn-delete, .actions{ display:none !important; }

      /* Inputs/textarea como texto limpio */
      input, textarea{
        border:none !important; background:transparent !important; box-shadow:none !important; padding:0 !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="document">
      <!-- HEADER (derecha, uno bajo el otro) -->
      <header class="header">
        <div class="header-right">
          <h1 class="company-name">Felson Watersafe ApS</h1>
          <p class="document-title">Følgeseddel</p>
        </div>
      </header>

      <!-- CONTENIDO -->
      <div class="content">
        <!-- Menos espacio entre campos -->
        <section class="info-grid">
          <div class="field-group">
            <label class="field-label" for="dato">Dato</label>
            <input type="date" class="field-input" id="dato">
          </div>
          <div class="field-group">
            <label class="field-label" for="ordre">Ordre Nr.</label>
            <input type="text" class="field-input" id="ordre" placeholder="Indtast ordrenummer...">
          </div>
          <div class="field-group" style="grid-column:1/-1">
            <label class="field-label" for="levering">Leveringsadresse</label>
            <textarea class="field-input field-textarea" id="levering" placeholder="Indtast leveringsadresse..."></textarea>
          </div>
        </section>

        <!-- TABLA (Antal | Beskrivelse) -->
        <section class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Antal</th>
                <th>Beskrivelse</th>
                <th style="width:60px"></th>
              </tr>
            </thead>
            <tbody id="table-body">
              <tr>
                <td><input type="number" class="table-input table-number" min="0" placeholder="0"></td>
                <td><textarea class="table-input" rows="1" placeholder="Indtast beskrivelse..."></textarea></td>
                <td style="text-align:center"><button class="btn-delete" title="Slet række">×</button></td>
              </tr>
            </tbody>
          </table>
          <button class="btn-add" id="add-row">+ Tilføj række</button>
        </section>

        <!-- BOTONES -->
        <div class="actions">
          <button class="btn-action btn secondary" id="save-pdf">Gem som PDF</button>
          <button class="btn-action btn primary" id="print">Udskriv</button>
        </div>
      </div>

      <!-- FOOTER (línea azul en pantalla; fijo en impresión) -->
      <footer class="footer">
        <div><strong>Felson Watersafe ApS</strong></div>
        <div>Gartnervej 4 • 6710 Esbjerg V</div>
        <div>CVR: DK26813522 • Tlf: 70 20 66 76 • E-mail: felson@felson.dk</div>
      </footer>
    </div>
  </div>

  <script>
    // Fecha de hoy por defecto
    const dateInput = document.getElementById('dato');
    if (dateInput) dateInput.valueAsDate = new Date();

    // Auto-expand de textarea en tabla
    document.addEventListener('input', (e)=>{
      if(e.target.matches('textarea.table-input')){
        const ta = e.target; ta.style.height='auto'; ta.style.height = ta.scrollHeight + 'px';
      }
    });

    // Añadir fila
    document.getElementById('add-row')?.addEventListener('click', ()=>{
      const tbody = document.getElementById('table-body');
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><input type="number" class="table-input table-number" min="0" placeholder="0"></td>
        <td><textarea class="table-input" rows="1" placeholder="Indtast beskrivelse..."></textarea></td>
        <td style="text-align:center"><button class="btn-delete" title="Slet række">×</button></td>
      `;
      tbody.appendChild(tr);
    });

    // Borrar fila (dejando al menos una)
    document.addEventListener('click', (e)=>{
      if(e.target.classList.contains('btn-delete')){
        const tbody = document.getElementById('table-body');
        if (tbody.rows.length > 1){
          e.target.closest('tr').remove();
        } else {
          alert('Der skal være mindst én række');
        }
      }
    });

    // Print (y placeholders visibles en PDF si el campo está vacío)
    function beforePrintFillPlaceholders(){
      document.querySelectorAll('input[type="text"], input[type="number"], textarea')
        .forEach(el=>{
          if(!el.value && el.placeholder){
            el.dataset._printedPlaceholder='1';
            el.value = el.placeholder;
          }
        });
    }
    function afterPrintRestore(){
      document.querySelectorAll('[data-_printedPlaceholder="1"]').forEach(el=>{
        el.value=''; el.removeAttribute('data-_printedPlaceholder');
      });
    }
    window.addEventListener('beforeprint', beforePrintFillPlaceholders);
    window.addEventListener('afterprint', afterPrintRestore);

    function doPrint(){
      beforePrintFillPlaceholders();
      setTimeout(()=>{ window.print(); setTimeout(afterPrintRestore, 300); }, 50);
    }

    document.getElementById('save-pdf')?.addEventListener('click', doPrint);
    document.getElementById('print')?.addEventListener('click', doPrint);
  </script>
</body>
</html>