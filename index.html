<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Følgeseddel Pro - Felson Watersafe ApS</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        :root {
            --brand-color: #00B0F0;
            --brand-color-dark: #008fbf;
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #10B981;
            --danger-color: #EF4444;
            --warning-color: #F59E0B;
            
            /* Light Theme */
            --bg-main-light: #f3f4f6;
            --bg-card-light: rgba(255, 255, 255, 0.98);
            --text-dark-light: #111827;
            --text-muted-light: #6B7280;
            --border-light: #e5e7eb;
            --shadow-light: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            
            /* Dark Theme */
            --bg-main-dark: #111827;
            --bg-card-dark: rgba(31, 41, 55, 0.95);
            --text-dark-dark: #F9FAFB;
            --text-muted-dark: #9CA3AF;
            --border-dark: #374151;
            --shadow-dark: 0 25px 50px -12px rgba(0, 0, 0, 0.4);

            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- Global Styles --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-main-light);
            min-height: 100vh;
            padding: 2rem;
            transition: background-color var(--transition), color var(--transition);
        }

        /* --- Dark Mode Styles --- */
        body.dark-mode {
            background: var(--bg-main-dark);
            color: var(--text-dark-dark);
        }
        
        .document-card, .login-card {
            background: var(--bg-card-light);
            border: 1px solid var(--border-light);
        }
        body.dark-mode .document-card, body.dark-mode .login-card {
            background: var(--bg-card-dark);
            border: 1px solid var(--border-dark);
        }
        
        .form-input, .form-textarea, .table-input, .table-textarea {
            background-color: #fff;
            color: var(--text-dark-light);
            border-color: var(--border-light);
        }
        body.dark-mode .form-input, body.dark-mode .form-textarea, body.dark-mode .table-input, body.dark-mode .table-textarea {
            background-color: #1f2937;
            color: var(--text-dark-dark);
            border-color: var(--border-dark);
        }
        
        /* ... (add more specific dark mode overrides as needed) */

        /* --- Main App Structure --- */
        .app-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        .document-card {
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            border-radius: 24px;
            box-shadow: var(--shadow-light);
            margin-bottom: 2rem;
        }
        body.dark-mode .document-card { box-shadow: var(--shadow-dark); }

        .card-header {
            padding: 2rem 3rem;
            border-bottom: 2px solid var(--brand-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo { color: var(--brand-color); font-size: 2rem; font-weight: 800; }
        .card-content { padding: 3rem; }
        .main-title {
            text-align: center; font-size: 1.25rem; font-weight: 700;
            margin-bottom: 2.5rem; text-transform: uppercase; letter-spacing: 0.2em;
        }
        .card-footer {
            padding: 1.5rem 3rem; border-top: 1px solid var(--border-light);
            text-align: center; font-size: 0.875rem; color: var(--text-muted-light);
        }
        body.dark-mode .card-footer {
             border-top: 1px solid var(--border-dark);
             color: var(--text-muted-dark);
        }

        /* --- Forms & Inputs --- */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
        .form-group { margin-bottom: 1rem; }
        .form-label {
            display: block; font-weight: 600; font-size: 0.875rem;
            color: var(--text-muted-light); margin-bottom: 0.5rem;
        }
        body.dark-mode .form-label { color: var(--text-muted-dark); }
        .form-input, .form-textarea {
            width: 100%; padding: 0.8rem 1rem; border: 1.5px solid;
            border-radius: 10px; font-size: 1rem; transition: var(--transition);
        }
        .form-input:focus, .form-textarea:focus {
            outline: none; border-color: var(--brand-color);
            box-shadow: 0 0 0 4px rgba(0, 176, 240, 0.1);
        }

        /* --- Dynamic Table --- */
        .data-table {
            width: 100%; border-collapse: separate; border-spacing: 0;
            border: 1px solid var(--border-color); border-radius: 12px;
            overflow: hidden; margin-top: 1.5rem;
        }
        body.dark-mode .data-table { border-color: var(--border-dark); }
        .data-table thead { background: linear-gradient(135deg, var(--brand-color) 0%, var(--brand-color-dark) 100%); }
        .data-table th {
            padding: 1rem; text-align: left; color: white;
            font-weight: 600; text-transform: uppercase; font-size: 0.75rem;
        }
        .data-table tbody tr:not(:last-child) td { border-bottom: 1px solid var(--border-color); }
        body.dark-mode .data-table tbody tr:not(:last-child) td { border-bottom: 1px solid var(--border-dark); }
        .data-table td { padding: 0.5rem 1rem; vertical-align: top; }
        .table-input, .table-textarea {
             width: 100%; padding: 0.5rem; border: 1px solid transparent; border-radius: 6px; font-size: 0.9375rem;
        }
        .table-input:focus, .table-textarea:focus {
            outline: none; border-color: var(--brand-color); background: rgba(0, 176, 240, 0.05);
        }
        .col-antal { width: 15%; text-align: center; }
        .col-pris, .col-total { width: 20%; text-align: right; }
        .col-beskrivelse { width: 40%; }
        .col-actions { width: 5%; text-align: center; }
        .table-total-row { font-weight: 700; font-size: 1.1rem; }
        .table-total-row td { padding-top: 1rem; }

        /* --- Buttons --- */
        .btn {
            padding: 0.75rem 1.5rem; border: none; border-radius: 10px;
            font-weight: 600; font-size: 0.875rem; cursor: pointer; text-transform: uppercase;
            transition: var(--transition);
        }
        .btn:hover { transform: translateY(-2px); }
        .actions-container { margin-top: 1.5rem; display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .btn-add { background: var(--success-color); color: white; }
        .btn-clear { background: white; color: var(--danger-color); border: 1.5px solid var(--danger-color); }
        .btn-delete { background: transparent; color: var(--text-muted-light); font-size: 1.25rem; }
        .main-actions { display: flex; gap: 1rem; justify-content: center; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-brand { background: var(--brand-color); color: white; }
        .btn-import-export { background: var(--text-muted-light); color: white; }
        
        /* --- UI Components --- */
        .toast {
            position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%);
            padding: 1rem 1.5rem; border-radius: 12px; box-shadow: var(--shadow-light);
            transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); z-index: 10000;
        }
        .toast.show { transform: translate(-50%, -120px); }
        /* Add other UI component styles (modal, etc.) here */

    </style>
</head>
<body>
    
    <div id="login-overlay" style="display: flex; position: fixed; inset: 0; align-items: center; justify-content: center; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); z-index: 99999;">
        <div class="login-card" style="padding: 2rem; width: 100%; max-width: 420px;">
            </div>
    </div>
    
    <main class="app-container" style="display: none;">
        <div class="document-card">
            <header class="card-header">
                <h1 class="logo">Felson Watersafe ApS</h1>
                </header>

            <div class="card-content">
                <h2 class="main-title">Følgeseddel</h2>
                
                <div class="document-management" style="margin-bottom: 2rem;">
                     <label class="form-label">Dokumentstyring</label>
                     <div style="display: flex; gap: 1rem;">
                         <input type="text" id="doc-name" class="form-input" placeholder="Nyt dokumentnavn...">
                         <button id="btn-save-doc" class="btn btn-primary">Gem</button>
                         <select id="doc-select" class="form-input"></select>
                         <button id="btn-delete-doc" class="btn btn-clear">Slet Valgt</button>
                     </div>
                </div>

                <div class="form-grid">
                    </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th class="col-antal">Antal</th>
                            <th class="col-beskrivelse">Beskrivelse</th>
                            <th class="col-pris">Pris pr. enhed</th>
                            <th class="col-total">Total</th>
                            <th class="col-actions"></th>
                        </tr>
                    </thead>
                    <tbody id="table-body"></tbody>
                    <tfoot>
                        <tr class="table-total-row">
                            <td colspan="3" style="text-align: right; padding-right: 1rem;">GRAND TOTAL:</td>
                            <td id="grand-total" style="text-align: right;">0.00</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
                <div class="actions-container">
                    <button class="btn btn-add" id="btn-add">+ Tilføj Række</button>
                    <button class="btn btn-clear" id="btn-clear">Ryd Formular</button>
                    <button class="btn btn-import-export" id="btn-export">Eksporter JSON</button>
                    <input type="file" id="import-file" style="display: none;">
                    <button class="btn btn-import-export" id="btn-import">Importer JSON</button>
                </div>
            </div>

            <footer class="card-footer">
                <p>Felson Watersafe ApS / CVR-nr. DK26813522 / Tlf. 70206676</p>
            </footer>
        </div>

        <div class="main-actions">
            <button class="btn btn-brand" id="btn-pdf">📄 Generer PDF</button>
            <button class="btn btn-primary" id="btn-print">🖨️ Udskriv</button>
        </div>
    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>

    <script>
    // Este es un esqueleto del JavaScript para ilustrar la complejidad.
    // El código completo sería extremadamente largo.
    (function() {
        'use strict';
        
        console.log("Følgeseddel Pro Application Initializing...");

        // --- MÓDULO DE AUTENTICACIÓN ---
        const Auth = {
            init() { console.log("Auth module initialized."); },
            // ... Lógica de login/logout/hashing ...
        };

        // --- MÓDULO DE UI ---
        const UI = {
            init() { console.log("UI module initialized."); },
            showToast(message, type = 'info') {
                console.log(`TOAST (${type}): ${message}`);
                // ... Lógica para mostrar notificaciones ...
            },
            updateGrandTotal(total) {
                const totalEl = document.getElementById('grand-total');
                if (totalEl) {
                    totalEl.textContent = total.toFixed(2);
                }
            }
            // ... Lógica para dark mode, modales, etc. ...
        };

        // --- MÓDULO DE ALMACENAMIENTO ---
        const Storage = {
            init() { console.log("Storage module initialized."); },
            saveDocument(name, data) { console.log(`Saving document: ${name}`); },
            loadDocument(name) { console.log(`Loading document: ${name}`); },
            deleteDocument(name) { console.log(`Deleting document: ${name}`); },
            listDocuments() { return ['Doc1', 'Doc2']; }
            // ... Lógica de cifrado/descifrado y localStorage ...
        };

        // --- MÓDULO DE PDF ---
        const PDFGenerator = {
            generate() {
                UI.showToast('Generating PDF...');
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Usar autoTable para una tabla perfecta
                doc.autoTable({
                    head: [['Antal', 'Beskrivelse', 'Pris', 'Total']],
                    body: [ /* ... datos de la tabla ... */ ],
                    startY: 50,
                    // ... muchas más opciones de personalización
                });
                
                doc.save('folgeseddel.pdf');
            }
        };

        // --- MÓDULO PRINCIPAL DE LA APP ---
        const App = {
            init() {
                console.log("Main app module initialized.");
                Auth.init();
                UI.init();
                Storage.init();
                this.setupEventListeners();
                this.loadInitialData();
            },
            setupEventListeners() {
                console.log("Setting up event listeners.");
                document.getElementById('btn-add').addEventListener('click', () => this.addRow());
                document.getElementById('table-body').addEventListener('input', () => this.calculateTotals());
                document.getElementById('btn-pdf').addEventListener('click', PDFGenerator.generate);
                // ... muchos más listeners para guardar, cargar, importar, exportar, etc.
            },
            addRow() {
                console.log("Adding a new row.");
                // ... Lógica para añadir una fila a la tabla ...
            },
            calculateTotals() {
                console.log("Calculating totals...");
                let grandTotal = 0;
                // ... Lógica para iterar filas y calcular totales ...
                UI.updateGrandTotal(grandTotal);
            },
            loadInitialData() {
                 // ... Lógica para cargar el último documento o uno por defecto ...
            }
        };
        
        // Iniciar la aplicación
        // En una app real, esto estaría condicionado por el éxito del login
        App.init();

    })();
    </script>
</body>
</html>
